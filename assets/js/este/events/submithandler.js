// Coffe Class fixed for Closure Compiler by Este.js
// Generated by CoffeeScript 1.4.0
/**
  @fileoverview Bubbled submit event.
*/



goog.provide('este.events.SubmitHandler');

goog.provide('este.events.SubmitHandler.EventType');

goog.require('este.Base');

goog.require('este.dom');

goog.require('goog.userAgent');



  

  /**
    @param {Element|Document=} node
    @param {boolean=} preventDefault
    @constructor
    @extends {este.Base}
  */


  este.events.SubmitHandler = function(node, preventDefault) {
    var eventType;
    if (node == null) {
      node = document;
    }
    this.preventDefault = preventDefault != null ? preventDefault : true;
    este.events.SubmitHandler.superClass_.constructor.call(this);
    eventType = goog.userAgent.IE && !goog.userAgent.isDocumentMode(9) ? 'focusin' : 'submit';
    this.on(node, eventType, this);
  }

  goog.inherits(este.events.SubmitHandler, este.Base);

  /**
    @enum {string}
  */


  este.events.SubmitHandler.EventType = {
    SUBMIT: 'submit'
  };

  /**
    @type {boolean}
    @protected
  */


  este.events.SubmitHandler.prototype.preventDefault = true;

  /**
    @param {goog.events.BrowserEvent} e
    @protected
  */


  este.events.SubmitHandler.prototype.handleEvent = function(e) {
    var form;
    if (e.type === 'focusin') {
      form = goog.dom.getAncestorByTagNameAndClass(e.target, 'form');
      if (form) {
        this.on(form, 'submit', this);
      }
      return;
    }
    var target = /** @type {Element} */ (e.target);

    e.json = este.dom.serializeForm(target);
    if (this.preventDefault) {
      e.preventDefault();
    }
    return this.dispatchEvent(e);
  };

  
