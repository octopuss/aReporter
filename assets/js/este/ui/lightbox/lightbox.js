// Coffe Class fixed for Closure Compiler by Este.js
// Generated by CoffeeScript 1.4.0
/**
	@fileoverview Canonical lightbox.
	todo
		add mobile support
	@see ../demos/lightbox.html
*/



goog.provide('este.ui.Lightbox');

goog.require('goog.ui.Component');

goog.require('este.ui.lightbox.AnchorClickHandler');

goog.require('este.ui.lightbox.View.create');



  

  /**
  		@param {este.ui.lightbox.AnchorClickHandler} anchorClickHandler
  		@param {Function} viewFactory
  		@constructor
  		@extends {goog.ui.Component}
  */


  este.ui.Lightbox = function(anchorClickHandler, viewFactory) {
    this.anchorClickHandler = anchorClickHandler;
    this.viewFactory = viewFactory;
  }

  goog.inherits(este.ui.Lightbox, goog.ui.Component);

  /**
  		@return {este.ui.Lightbox}
  */


  este.ui.Lightbox.create = function() {
    var factory, handler;
    handler = new este.ui.lightbox.AnchorClickHandler;
    factory = este.ui.lightbox.View.create;
    return new este.ui.Lightbox(handler, factory);
  };

  /**
  		@type {este.ui.lightbox.AnchorClickHandler}
  */


  este.ui.Lightbox.prototype.anchorClickHandler = null;

  /**
  		@type {Function}
  */


  este.ui.Lightbox.prototype.viewFactory = null;

  /**
  		@type {este.ui.lightbox.View}
  		@protected
  */


  este.ui.Lightbox.prototype.view = null;

  /**
  		Close view.
  */


  este.ui.Lightbox.prototype.close = function() {
    this.removeChild(this.view);
    return this.view.dispose();
  };

  /**
  		@inheritDoc
  */


  este.ui.Lightbox.prototype.decorateInternal = function(element) {
    este.ui.Lightbox.superClass_.decorateInternal.call(this, element);
    this.anchorClickHandler.decorate(element);
  };

  /**
  		@inheritDoc
  */


  este.ui.Lightbox.prototype.enterDocument = function() {
    este.ui.Lightbox.superClass_.enterDocument.call(this);
    this.getHandler().listen(this.anchorClickHandler, 'click', this.onAnchorClickHandlerClick);
  };

  /**
  		@param {Object} e
  		@protected
  */


  este.ui.Lightbox.prototype.onAnchorClickHandlerClick = function(e) {
    this.view = this.viewFactory(e.currentAnchor, e.anchors);
    this.addChild(this.view, true);
    return this.getHandler().listen(this.view, 'close', this.close);
  };

  
