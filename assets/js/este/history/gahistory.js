// Coffe Class fixed for Closure Compiler by Este.js
// Generated by CoffeeScript 1.4.0
/**
  @fileoverview Google Analytics tracking history

  @author jiri.kopsa(at)proactify.com (Jiří Kopsa)
*/



goog.provide('este.history.GAHistory');

goog.require('este.History');

goog.require('goog.debug.Logger');



  

  /**
    @param {string} gaAccountId
    @param {string=} pathPrefix Path prefix to use if storing tokens in the path.
    The path prefix should start and end with slash.
    @param {boolean=} forceHash If true, este.History will degrade to hash even
    if html5history is supported.
    @constructor
    @extends {este.History}
  */


  este.history.GAHistory = function(gaAccountId, pathPrefix, forceHash) {
    if (!window['_gaq']) {
      window['_gaq'] = [];
    }
    window['_gaq'].push(['_setAccount', gaAccountId]);
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);;

  }

  goog.inherits(este.history.GAHistory, este.History);

  /**
    @inheritDoc
  */


  este.history.GAHistory.prototype.onNavigate = function(e) {
    var url;
    este.history.GAHistory.superClass_.onNavigate.call(this, e);
    url = window.location.protocol + "//" + window.location.host + this.pathPrefix + this.history.getToken();
    window['_gaq'].push(['_trackPageview', url]);
    this.logger_.info("GA: trackPageview: " + url);
  };

  /**
    @type {goog.debug.Logger}
    @private
  */


  este.history.GAHistory.prototype.logger_ = goog.debug.Logger.getLogger('este.history.GAHistory');

  
